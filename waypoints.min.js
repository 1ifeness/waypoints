// Generated by CoffeeScript 1.3.3
(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y=[].slice;e=window.jQuery,t=e(window),i={},s=1,u={},o="waypoints-context-id",c="resize.waypoints",h="scroll.waypoints",p=1,d="waypoint.reached",v="waypoints-waypoint-ids",m="waypoint",g="waypoints",window.contexts=u,a=function(t){var n;return n=e(t).data(v),e.map(n,function(e){return i[e]})},n=function(){function t(t){var n=this;this.$element=t,this.element=t[0],this.didResize=!1,this.didScroll=!1,this.id=s++,this.oldScroll=0,this.waypoints={},t.data(o,this.id),u[this.id]=this,t.bind(h,function(){var t;if(!n.didScroll)return n.didScroll=!0,t=function(){return n.doScroll(),n.didScroll=!1},window.setTimeout(t,e[g].settings.scrollThrottle)}),t.bind(c,function(){var t;if(!n.didResize)return n.didResize=!0,t=function(){return e[g]("refresh"),n.didResize=!1},window.setTimeout(t,e[g].settings.resizeThrottle)})}return t.prototype.doScroll=function(){var t,n,r,i,s=this;r=this.$element.scrollTop(),t=r>this.oldScroll,i=[],e.each(this.waypoints,function(e,n){var o,u,a;return t?o=s.oldScroll<(u=n.offset)&&u<=r:o=r<(a=n.offset)&&a<=s.oldScroll,o&&i.push(n),!0}),n=i.length,(!this.oldScroll||!r)&&e[g]("refresh"),this.oldScroll=r;if(!n)return;return i.sort(function(e,t){return e.offset-t.offset}),t||i.reverse(),e.each(i,function(e,r){if(r.options.continuous||e===n-1)return r.trigger([t?"down":"up"])})},t.prototype.refresh=function(t){var n,r,i,s,o=this;return s=e.isWindow(this.element),r=i=0,n=e[g]("viewportHeight"),s||(r=this.$element.offset().top,n=this.$element.height(),i=this.$element.scrollTop()),t==null&&(t=this.waypoints),e.each(t,function(t,s){var u,a,f,l;u=s.options.offset,a=s.offset,e.isFunction(s.options.offset)?u=s.options.offset.apply(s.element):typeof s.options.offset=="string"&&(u=parseFloat(s.options.offset),s.options.offset.indexOf("%")&&(u=Math.ceil(n*u/100))),s.offset=s.$element.offset().top-r+i-u;if(s.options.onlyOnScroll||!s.enabled)return;if(a!==null&&a<(f=o.oldScroll)&&f<=s.offset)return s.trigger(["up"]);if(a!==null&&a>(l=o.oldScroll)&&l>=s.offset)return s.trigger(["down"]);if(a===null&&o.$element.scrollTop()>s.offset)return s.trigger(["down"])})},t.prototype.checkEmpty=function(){if(e.isEmptyObject(this.waypoints))return delete u[this.id]},t}(),r=function(){function t(t,n,r){var s,o;r=e.extend({},e.fn[m].defaults,r),r.offset==="bottom-in-view"&&(r.offset=function(){var t;return t=e[g]("viewportHeight"),e.isWindow(n.element)||(t=n.$element.height()),t-e(this).outerHeight()}),this.$element=t,this.element=t[0],this.options=r,this.offset=null,this.f=r!=null?r.handler:void 0,this.context=n,this.id=p++,this.enabled=r.enabled,n.waypoints[this.id]=this,i[this.id]=this,s=(o=t.data(v))!=null?o:[],s.push(this.id),t.data(v,s),t.data("waypointPlugin",this)}return t.prototype.trigger=function(e){if(!this.enabled)return;this.f!=null&&this.f.apply(this.element,e),this.$element.trigger(d,e);if(this.options.triggerOnce)return this.destroy()},t.prototype.disable=function(){return this.enabled=!1},t.prototype.enable=function(){return this.context.refresh([this]),this.enabled=!0},t.prototype.destroy=function(){return delete i[this.id],delete this.context.waypoints[this.id],this.context.checkEmpty()},t}(),l={init:function(t,i){var s;return i==null&&(i={}),(s=i.handler)==null&&(i.handler=t),this.each(function(){var t,s,a,f;return t=e(this),a=(f=i.context)!=null?f:e.fn[m].defaults.context,e.isWindow(a)||(a=t.closest(a)),a=e(a),s=u[a.data(o)],s||(s=new n(a)),new r(t,s,i)}),e[g]("refresh"),this},disable:function(){return l._invoke(this,"disable")},enable:function(){return l._invoke(this,"enable")},destroy:function(){return l._invoke(this,"destroy")},_invoke:function(t,n){return t.each(function(){var t;return t=a(this),e.each(t,function(e,t){return t[n]()})}),this}},e.fn[m]=function(){var t,n;return n=arguments[0],t=2<=arguments.length?y.call(arguments,1):[],l[n]?l[n].apply(this,t):e.isFunction(n)||!n?l.init.apply(this,arguments):e.isPlainObject(n)?l.init.apply(this,[null,n]):e.error("The "+n+" method does not exist in jQuery Waypoints.")},e.fn[m].defaults={continuous:!0,offset:0,triggerOnce:!1,context:window,enabled:!0},f={refresh:function(){return e.each(u,function(e,t){return t.refresh()})},viewportHeight:function(){var e;return(e=window.innerHeight)!=null?e:t.height()},aggregate:function(){var t;return t=[],e.each(u,function(n,r){return e.each(r.waypoints,function(e,n){return t.push(n)})}),t.sort(function(e,t){return e.offset-t.offset}),e.map(t,function(e){return e.$element})}},e[g]=function(e){return f[e]?f[e]():f.aggregate()},e[g].settings={resizeThrottle:200,scrollThrottle:100},t.load(function(){return e[g]("refresh")})}).call(this);